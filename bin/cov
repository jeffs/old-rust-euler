#!/bin/sh
#
# For coverage, pass `cargo tarpaulin --out Xml`, then convert to HTML:
#
#   pip install pycobertura
#   pycobertura show --format html --output coverage.html cobertura.xml
#
# See also: https://github.com/xd009642/tarpaulin

set -eou pipefail

docker run --rm -it \
    --security-opt seccomp=unconfined \
    -v "$PWD:/volume" \
    xd009642/tarpaulin \
    cargo tarpaulin --out Xml \
    "$@"

pycobertura show --format html --output coverage.html cobertura.xml
